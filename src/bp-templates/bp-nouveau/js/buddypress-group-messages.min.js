window.wp=window.wp||{},window.bp=window.bp||{},function(e,s){"undefined"!=typeof BP_Nouveau&&(_.extend(bp,_.pick(wp,"Backbone","ajax","template")),bp.Models=bp.Models||{},bp.Collections=bp.Collections||{},bp.Views=bp.Views||{},bp.Nouveau=bp.Nouveau||{},bp.Models.ACReply=Backbone.Model.extend({defaults:{gif_data:{}}}),bp.Nouveau.GroupMessages={start:function(){this.views=new Backbone.Collection,this.displayFeedback(BP_Nouveau.group_messages.invites_form_all,"info"),this.mediumEditor=!1,this.setupGlobals();var e=s("body").find("#group-messages-send-to-input"),a=1;this.addSelect2(e),this.activateTinyMce();var o=s("#group-messages-container .bb-groups-messages-right .bp-messages-feedback"),t=s("#group-messages-container .bb-groups-messages-right .bp-messages-feedback .bp-feedback p"),r=s("#group-messages-container .bb-groups-messages-left .group-messages-members-listing .bp-messages-feedback"),g=s("#group-messages-container .bb-groups-messages-left .group-messages-members-listing .bp-messages-feedback .bp-feedback p");/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)),s("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .select2-container .selection .select2-selection--multiple .select2-selection__rendered .select2-search--inline .select2-search__field").prop("disabled",!0),s(document).on("click","#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .select2-container .selection .select2-selection--multiple .select2-selection__rendered .select2-search--inline .select2-search__field",function(){s(this).prop("disabled",!0)}),s(s(".group-messages-members-listing #members-list")).scroll(this.loadMoreMessageMembers),e.on("select2:unselect",function(e){var a=e.params.data;s('#group-messages-send-to-input option[value="'+a.id+'"]').each(function(){s(this).remove()}),s("#item-body #group-messages-container .bb-groups-messages-left #members-list li."+a.id).removeClass("selected"),s("#item-body #group-messages-container .bb-groups-messages-left #members-list li."+a.id+" .action button").attr("data-bp-tooltip",BP_Nouveau.group_messages.add_recipient)}),e.select2().prop("disabled",!0);var m={action:"groups_get_group_members_listing",nonce:BP_Nouveau.group_messages.nonces.retrieve_group_members,group:BP_Nouveau.group_messages.group_id,type:"all",page:a};s.ajax({type:"POST",url:BP_Nouveau.ajaxurl,async:!1,data:m,success:function(e){if(e.success&&"no_member"!==e.data.results)return s(".group-messages-members-listing #members-list").html(""),s(".group-messages-members-listing #members-list").html(e.data.results),s(".group-messages-members-listing .last").html(""),s(".group-messages-members-listing .last").html(e.data.pagination),a=e.data.page,s("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback").hide(),s("#item-body #group-messages-container .bb-groups-messages-left .total-members-text").html(""),s("#item-body #group-messages-container .bb-groups-messages-left .total-members-text").html(e.data.total_count),a;s(".group-messages-members-listing #members-list").html(""),s(".group-messages-members-listing .last").html(""),s("#group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").addClass("error"),g.html(BP_Nouveau.group_messages.no_member)}}),s(".group-messages-select-members-dropdown").on("change",function(){a=1,e.val("").trigger("change");var m=this.value;if(m){if(o.addClass("bp-messages-feedback-hide"),r.addClass("bp-messages-feedback-hide"),t.html(""),"all"===m){if(s(".bb-groups-messages-left").removeClass("bb-select-member-view"),s(".bb-groups-messages-left .bb-groups-messages-left-inner .bb-panel-head .add-more-members").length&&s(".bb-groups-messages-left .bb-groups-messages-left-inner .bb-panel-head .add-more-members").remove(),s("#group-messages-container .bb-groups-messages-left .group-messages-members-listing #members-list").hasClass("all-members")||s("#group-messages-container .bb-groups-messages-left .group-messages-members-listing #members-list").addClass("all-members"),s("#group-messages-send-to-input option").each(function(){s(this).remove()}),!e.find("option[value='all']").length){var i=new Option(BP_Nouveau.group_messages.select_default_text,BP_Nouveau.group_messages.select_default_value,!0,!0);e.append(i).trigger("change")}e.select2().prop("disabled",!0),o.removeClass("bp-messages-feedback-hide"),s("#group-messages-container .bb-groups-messages-right .bp-messages-feedback .bp-feedback").addClass("info"),t.html(BP_Nouveau.group_messages.invites_form_all),s("#group-messages-container .bb-groups-messages-left .group-messages-search").hide(),e.select2("data",{id:BP_Nouveau.group_messages.select_default_value,text:BP_Nouveau.group_messages.select_default_text}),e.val("all").trigger("change");n={action:"groups_get_group_members_listing",nonce:BP_Nouveau.group_messages.nonces.retrieve_group_members,group:BP_Nouveau.group_messages.group_id,type:"all",page:a};return s.ajax({type:"POST",url:BP_Nouveau.ajaxurl,async:!1,data:n,success:function(e){if(e.success&&"no_member"!==e.data.results)return s(".group-messages-members-listing #members-list").html(""),s(".group-messages-members-listing #members-list").html(e.data.results),s(".group-messages-members-listing .last").html(""),s(".group-messages-members-listing .last").html(e.data.pagination),a=e.data.page,s("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback").hide(),s("#item-body #group-messages-container .bb-groups-messages-left .total-members-text").html(""),s("#item-body #group-messages-container .bb-groups-messages-left .total-members-text").html(e.data.total_count),a;s(".group-messages-members-listing #members-list").html(""),s(".group-messages-members-listing .last").html(""),s("#group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").addClass("error"),g.html(BP_Nouveau.group_messages.no_member)}}),1}s(".bb-groups-messages-left").addClass("bb-select-member-view"),s("#group-messages-container .bb-groups-messages-left .group-messages-members-listing #members-list").hasClass("all-members")&&s("#group-messages-container .bb-groups-messages-left .group-messages-members-listing #members-list").removeClass("all-members"),s('#group-messages-send-to-input option[value="all"]').each(function(){s(this).remove()}),e.select2().prop("disabled",!1),s("#group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .select2-container .selection .select2-selection--multiple .select2-selection__rendered .select2-search--inline .select2-search__field").prop("disabled",!0),o.removeClass("bp-messages-feedback-hide"),r.removeClass("bp-messages-feedback-hide"),s("#group-messages-container .bb-groups-messages-right .bp-messages-feedback .bp-feedback").addClass("info"),t.html(BP_Nouveau.group_messages.invites_form_separate),s("#group-messages-container .bb-groups-messages-left .group-messages-search").show(),s("#group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").addClass("loading"),g.html(BP_Nouveau.group_messages.loading);var n={action:"groups_get_group_members_listing",nonce:BP_Nouveau.group_messages.nonces.retrieve_group_members,group:BP_Nouveau.group_messages.group_id,type:"individual",page:a};s.ajax({type:"POST",url:BP_Nouveau.ajaxurl,async:!1,data:n,success:function(e){if(e.success&&"no_member"!==e.data.results)return s(".group-messages-members-listing #members-list").html(""),s(".group-messages-members-listing #members-list").html(e.data.results),s(".group-messages-members-listing .last").html(""),s(".group-messages-members-listing .last").html(e.data.pagination),a=e.data.page,s("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback").hide(),s("#item-body #group-messages-container .bb-groups-messages-left .total-members-text").html(""),a;s(".group-messages-members-listing #members-list").html(""),s(".group-messages-members-listing .last").html(""),s("#group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").addClass("error"),g.html(BP_Nouveau.group_messages.no_member)}})}}),s(document).on("click","#item-body #group-messages-container .bb-groups-messages-left #members-list li.load-more .group-message-load-more-button",function(){s("#group-messages-container .group-messages-members-listing .last #bp-group-messages-next-page").trigger("click")}),s(document).on("click","#item-body #group-messages-container .bb-groups-messages-left #members-list li .action .group-add-remove-invite-button",function(){var a=s(this).attr("data-bp-user-id"),o=s(this).attr("data-bp-user-name"),t={id:a,text:o};if(s(this).closest("li").hasClass("selected")){s(this).closest("li").removeClass("selected");var r=[];s.grep(e.select2("data"),function(e){return e.id!=a}).forEach(function(e){r.push(+e.id)}),e.val(r).trigger("change"),s('#group-messages-send-to-input option[value="'+a+'"]').each(function(){s(this).remove()}),s(this).attr("data-bp-tooltip",BP_Nouveau.group_messages.add_recipient)}else{if(s(this).closest("li").addClass("selected"),!e.find("option[value='"+t.id+"']").length){var g=new Option(t.text,t.id,!0,!0);e.append(g).trigger("change")}s(this).attr("data-bp-tooltip",BP_Nouveau.group_messages.remove_recipient)}}),s(document).on("click","#item-body #group-messages-container .bb-groups-messages-left .last #bp-group-messages-next-page",function(){s("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback").show(),s("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").addClass("info"),g.html(BP_Nouveau.group_messages.loading);var e={action:"groups_get_group_members_listing",nonce:BP_Nouveau.group_messages.nonces.retrieve_group_members,group:BP_Nouveau.group_messages.group_id,type:s(".group-messages-select-members-dropdown :selected").val(),page:a};s.ajax({type:"POST",url:BP_Nouveau.ajaxurl,data:e,success:function(e){e.success&&"no_member"!==e.data.results?(s(".group-messages-members-listing #members-list").append(e.data.results),s(".group-messages-members-listing .last").html(""),s(".group-messages-members-listing .last").html(e.data.pagination),a=e.data.page,s("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback").hide()):(s(".group-messages-members-listing #members-list").html(""),s(".group-messages-members-listing .last").html(""),s("#group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").addClass("error"),g.html(BP_Nouveau.group_messages.no_member))}})}),s(document).on("click","#item-body #group-messages-container .bb-groups-messages-left .last #bp-group-messages-prev-page",function(){s("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback").show(),s("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").addClass("info"),g.html(BP_Nouveau.group_messages.loading),a-=2;var e={action:"groups_get_group_members_listing",nonce:BP_Nouveau.group_messages.nonces.retrieve_group_members,group:BP_Nouveau.group_messages.group_id,type:s(".group-messages-select-members-dropdown :selected").val(),page:a};s.ajax({type:"POST",url:BP_Nouveau.ajaxurl,data:e,success:function(e){e.success&&"no_member"!==e.data.results?(s(".group-messages-members-listing #members-list").html(""),s(".group-messages-members-listing #members-list").html(e.data.results),s(".group-messages-members-listing .last").html(""),s(".group-messages-members-listing .last").html(e.data.pagination),s("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback").hide(),a=e.data.page):(s(".group-messages-members-listing #members-list").html(""),s(".group-messages-members-listing .last").html(""),s("#group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").addClass("error"),g.html(BP_Nouveau.group_messages.no_member))}})}),s(document).on("click","#item-body #group-messages-container .bb-groups-messages-left #group_messages_search",function(){var e=s("#item-body #group-messages-container .bb-groups-messages-left #group_messages_search").val();if(""===e)return!1;var o={action:"groups_get_group_members_listing",nonce:BP_Nouveau.group_messages.nonces.retrieve_group_members,group:BP_Nouveau.group_messages.group_id,type:s("#item-body #group-messages-container .bb-groups-messages-left #group_messages_search").val(),term:e,page:1};s.ajax({type:"POST",url:BP_Nouveau.ajaxurl,data:o,success:function(e){e.success&&"no_member"!==e.data.results?(s(".group-messages-members-listing #members-list").html(""),s(".group-messages-members-listing #members-list").html(e.data.results),s(".group-messages-members-listing .last").html(""),s(".group-messages-members-listing .last").html(e.data.pagination),s("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback").hide(),a=e.data.page):(s(".group-messages-members-listing #members-list").html(""),s(".group-messages-members-listing .last").html(""),s("#group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").addClass("error"),g.html(BP_Nouveau.group_messages.no_member))}})}),s(document).on("click","#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-bottom #send_group_message_button",function(a){a.preventDefault();var o,t,r=[];"all"===s(".group-messages-select-members-dropdown :selected").val()?(o="all",r=[]):(o="individual",s.grep(e.select2("data"),function(e){return 0!=e.id}).forEach(function(e){r.push(+e.id)})),t="open"===s(".group-messages-type :selected").val()?"open":"private";var g="",m="";void 0!==window.group_messages_editor&&(m=window.group_messages_editor),g=m.getContent(),m&&""===s.trim(m.getContent().replace("<p><br></p>",""))?g="":m||""!==s.trim(s("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form").find("#group_message_content").val())||(g="");var i=s("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-bottom #bp_group_messages_media").val(),n=s("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-bottom #bp_group_messages_gif").val(),u=s("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .bp-messages-feedback .bp-feedback-content-no-error"),p=s("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .bp-messages-feedback .bp-feedback-recipient-no-error");if(""===g&&""===i&&""===n){if(!u.length){var b='<div class="bp-feedback error bp-feedback-content-no-error"><span class="bp-icon" aria-hidden="true"></span><p> '+BP_Nouveau.group_messages.no_content+" </p></div>";s("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .bp-messages-feedback").append(b)}return!1}if(u.length&&u.remove(),"all"!==s(".group-messages-select-members-dropdown :selected").val()&&0===r.length){if(!p.length){var l='<div class="bp-feedback error bp-feedback-content-no-error"><span class="bp-icon" aria-hidden="true"></span><p> '+BP_Nouveau.group_messages.no_recipient+" </p></div>";s("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-top .bp-messages-feedback").append(l)}return!1}p.length&&p.remove();var d={action:"groups_get_group_members_send_message",nonce:BP_Nouveau.group_messages.nonces.send_messages_users,group:BP_Nouveau.group_messages.group_id,content:s("#item-body #group-messages-container .bb-groups-messages-right #send_group_message_form .bb-groups-messages-right-bottom #group_message_content_hidden").val(),media:i,users:o,users_list:r,type:t,gif:n};s.ajax({type:"POST",url:BP_Nouveau.ajaxurl,data:d,success:function(e){if(e.success){s("#item-body #group-messages-container .bb-groups-messages-left").hide(),s("#item-body #group-messages-container .bb-groups-messages-right").html("");a='<div class="bp-feedback success bp-feedback-content-no-error"><span class="bp-icon" aria-hidden="true"></span><p> '+e.data.feedback+" </p></div>";s("#item-body #group-messages-container .bb-groups-messages-right").append(a),e.data.redirect_link&&(window.location.href=e.data.redirect_link)}else{s("#item-body #group-messages-container .bb-groups-messages-left").hide(),s("#item-body #group-messages-container .bb-groups-messages-right").html("");var a='<div class="bp-feedback error bp-feedback-content-no-error"><span class="bp-icon" aria-hidden="true"></span><p> '+e.data.feedback+" </p></div>";s("#item-body #group-messages-container .bb-groups-messages-right").append(a)}}})}),s(document).on("click","#item-body #group-messages-container .bb-groups-messages-left #group_messages_search_submit",function(e){e.preventDefault(),s("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback").show(),s("#group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").removeClass("error"),s("#group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").addClass("info"),g.html(BP_Nouveau.group_messages.loading);var a=s("#item-body #group-messages-container .bb-groups-messages-left .group-messages-search .bp-search #group_messages_search_form #group_messages_search").val(),o={action:"groups_get_group_members_listing",nonce:BP_Nouveau.group_messages.nonces.retrieve_group_members,group:BP_Nouveau.group_messages.group_id,type:s(".group-messages-select-members-dropdown :selected").val(),page:1,term:a};s.ajax({type:"POST",url:BP_Nouveau.ajaxurl,data:o,success:function(e){e.success&&"no_member"!==e.data.results?(s(".group-messages-members-listing #members-list").html(""),s(".group-messages-members-listing #members-list").html(e.data.results),s(".group-messages-members-listing .last").html(""),s(".group-messages-members-listing .last").html(e.data.pagination),s("#item-body #group-messages-container .bb-groups-messages-left .bp-messages-feedback").hide()):(s(".group-messages-members-listing #members-list").html(""),s(".group-messages-members-listing .last").html(""),s("#group-messages-container .bb-groups-messages-left .bp-messages-feedback .bp-feedback").addClass("error"),g.html(BP_Nouveau.group_messages.no_member))}})}),s(".bb-close-select-members").on("click",function(e){e.preventDefault(),s(".bb-groups-messages-left").removeClass("bb-select-member-view"),s(".bb-groups-messages-left .bb-groups-messages-left-inner .bb-panel-head .add-more-members").length||s(".bb-groups-messages-left .bb-groups-messages-left-inner .bb-panel-head").append('<div class="add-more-members"><a class="bb-add-members" href="#"><span class="dashicons dashicons-plus-alt"></span></a></div>')}),s(document).on("click","#item-body #group-messages-container .bb-groups-messages-left .bb-groups-messages-left-inner .bb-panel-head .add-more-members .bb-add-members",function(){s(".bb-groups-messages-left").addClass("bb-select-member-view")})},setupGlobals:function(){void 0!==window.Dropzone&&void 0!==BP_Nouveau.media&&(window.Dropzone.autoDiscover=!1,this.dropzone_options={url:BP_Nouveau.ajaxurl,timeout:108e5,acceptedFiles:"image/*",autoProcessQueue:!0,addRemoveLinks:!0,uploadMultiple:!1,maxFilesize:void 0!==BP_Nouveau.media.max_upload_size?BP_Nouveau.media.max_upload_size:2}),this.dropzone_obj=null,this.dropzone_media=[],this.models=[]},activateTinyMce:function(){if(_.isUndefined(window.MediumEditor))"undefined"!=typeof tinymce&&tinymce.EditorManager.execCommand("mceAddEditor",!0,"message_content");else{window.group_messages_editor=new window.MediumEditor("#group_message_content",{placeholder:{text:BP_Nouveau.group_messages.type_message,hideOnClick:!0},toolbar:{buttons:["bold","italic","unorderedlist","orderedlist","quote","anchor"]}}),window.group_messages_editor.subscribe("editableInput",function(){s("#group_message_content_hidden").val(window.group_messages_editor.getContent())}),_.isUndefined(BP_Nouveau.media)||_.isUndefined(BP_Nouveau.media.emoji)||!s("#group_message_content").length||s("#group_message_content").emojioneArea({standalone:!0,hideSource:!1,container:s("#whats-new-toolbar > .post-emoji"),autocomplete:!1,pickerPosition:"bottom",hidePickerOnBlur:!0,useInternalCDN:!1,events:{emojibtn_click:function(){s("#group_message_content")[0].emojioneArea.hidePicker()}}});var e=bp.Nouveau.getLinkParams(null,"r")||null;_.isNull(e)||s("#message_content").focus()}},addMentions:function(){s(this.el).find("#group-messages-send-to-input").bp_mentions({data:[],suffix:" "})},addSelect2:function(e){var a=[];e.select2({placeholder:e.attr("placeholder"),minimumInputLength:1,ajax:{url:bp.ajax.settings.url,dataType:"json",delay:250,data:function(e){return s.extend({},e,{nonce:BP_Nouveau.group_messages.nonces.retrieve_group_members,action:"groups_get_group_potential_user_send_messages",group:BP_Nouveau.group_messages.group_id})},cache:!0,processResults:function(e){return!1===jQuery.isEmptyObject(a)&&s.each(a,function(s,a){for(var o=0;o<e.data.results.length;o++)e.data.results[o].id===a&&e.data.results.splice(o,1)}),{results:e&&e.success?e.data.results:[]}}}}),e.on("select2:select",function(e){var s=e.params.data;a.push(s.id)}),e.on("select2:unselect",function(e){var s=e.params.data;a=jQuery.grep(a,function(e){return e!==s.id})})},displayFeedback:function(e,a){s("#group-messages-container .bb-groups-messages-right .bp-messages-feedback").removeClass("bp-messages-feedback-hide"),s("#group-messages-container .bb-groups-messages-right .bp-messages-feedback .bp-feedback").addClass(a),s("#group-messages-container .bb-groups-messages-right .bp-messages-feedback .bp-feedback p").html(e)},removeFeedback:function(){s("#group-messages-container .bb-groups-messages-right .bp-messages-feedback").addClass("bp-messages-feedback-hide"),s("#group-messages-container .bb-groups-messages-right .bp-messages-feedback .bp-feedback p").html("")},loadMoreMessageMembers:function(){var e=s("#group-messages-container .group-messages-members-listing #members-list li.load-more");if(e.length){var a=e.offset().top,o=e.offset().top+e.outerHeight(),t=s(window).scrollTop()+s(window).innerHeight(),r=s(window).scrollTop();t>a&&r<o&&(e.remove(),s("#group-messages-container .group-messages-members-listing .last #bp-group-messages-next-page").trigger("click"))}}},bp.Nouveau.GroupMessages.start())}(bp,jQuery);